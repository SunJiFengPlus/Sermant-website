# Sermant-backend Module

This document focuses on the [**Sermant-backend**](https://github.com/huaweicloud/Sermant/tree/develop/sermant-backend). Its main function is to send messages generated during the `core function` execution to Kafka, which plays the role of turning short connections into long connections.

**Positioning**: 

- Data processing backend module and frontend information display module for Sermant.

**Functionality**:

- Receive data from framework and plugin and write to Kafka.
- Provide frontend to display heartbeat information of framework and plugin.

**How to Use**:

- The runtime environment of backend requires Kafka. The default configuration of Kafka is as follows. If the environment configuration of Kafka is different, you need to modify the [kafka configuration](https://github.com/huaweicloud/Sermant/tree/develop/sermant-backend/src/main/resources/application.properties)
  ```properties
  spring.kafka.bootstrap-servers=127.0.0.1:9092
  ```
- The framework depends on backend to run. The default configuration of backend is as follows. If the host application and backend are not running on the same machine, you need to modify the [backend configuration](https://github.com/huaweicloud/Sermant/tree/develop/sermant-agentcore/sermant-agentcore-config/config/config.properties)
    ```properties
    backendIp=127.0.0.1
    backendPort=6888
    ```
- After running the backend module, check startup information of framework and plugin at http://127.0.0.1:8900
  <MyImage src="/docs-img/backend_sermant_info.png"></MyImage>
- The default listening port of backend is 8900. If the port is occupied or needs to be set to another port, please modify [port of backend](https://github.com/huaweicloud/Sermant/tree/develop/sermant-backend/src/main/resources/application.properties)
  ```properties
  server.port=8900
  ```
- The frontend of Backend frontend is developed by Vue framework. At present, the frontend only provides simple information to show the running status of the framework. If the frontend does not meet your requirements, please modify the [frontend](https://github.com/huaweicloud/Sermant/tree/develop/sermant-backend/src/main/webapp).
- Backend requires that the data generated by the framework and the plugin are stored in different topics of Kafka. If the following existing topic configuration does not meet the requirements, developers need to add topic configuration in the same format.To add topic, please modify [topic configuration](https://github.com/huaweicloud/Sermant/tree/develop/sermant-backend/src/main/resources/application.properties).
  ```properties
  datatype.topic.mapping.0=topic-heartbeat
  datatype.topic.mapping.1=topic-log
  datatype.topic.mapping.2=topic-flowcontrol
  datatype.topic.mapping.3=topic-flowrecord
  datatype.topic.mapping.4=topic-server-monitor
  datatype.topic.mapping.5=topic-open-jdk-jvm-monitor
  datatype.topic.mapping.6=topic-ibm-jvm-monitor
  datatype.topic.mapping.7=topic-agent-registration
  datatype.topic.mapping.8=topic-agent-monitor
  datatype.topic.mapping.9=topic-agent-span-event
  datatype.topic.mapping.10=topic-druid-monitor
  datatype.topic.mapping.11=topic-flowcontrol-metric
  ```
- Backend does not strongly rely on Kafka service, the default configuration of heartbeat data is to write to the cache, if you need to write data to Kafka, just change the following configuration of [backend configuration file](https://github.com/huaweicloud/Sermant/tree/develop/sermant-backend/src/main/resources/application.properties) to `false`.
  ```properties
  heartbeat.cache=true
  ```